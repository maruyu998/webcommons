# セッション継続システム（記憶術）

## 概要
Claude Codeでの複数セッション間でのコンテキスト保持と並行開発トラック管理のためのドキュメント戦略

## ドキュメント戦略

### 1. セッション固有ドキュメント
各主要開発領域が独自の`docs/`ディレクトリを保持：
- `{component}/docs/`: コンポーネント固有の開発進捗
- プロジェクトルート`docs/`: 全体プロジェクトドキュメント

### 2. セッション進捗追跡
各`docs/`ディレクトリに以下を含む：
- `session_progress.md`: 現在の状況、次のステップ、セッション識別
- `technical_details.md`: 実装の詳細、アーキテクチャノート
- 機能固有ドキュメント（必要に応じて）

**重要**: これらのドキュメントは基本的に日本語で作成する。Claude Codeとの日本語でのやり取りにより、コンテキストの理解と継続が向上する。

### 3. セッション識別方法
作業を継続する際の識別方法：
- 任意のIDではなく**内容による説明**
- 進捗ドキュメントでの**現在の状況サマリー**
- **作業中の特定コンポーネント**の明確な記述

## セッション継続プロトコル

### 新しいセッション開始時
1. 関連する`docs/session_progress.md`を読んで現在の状態を理解
2. どの開発トラックを継続するかユーザーに確認
3. 作業進行に応じて進捗ドキュメントを更新
4. 要件を仮定せず、常に明確化を求める

### ドキュメント更新タイミング
- 重要な実装完了時
- セッション終了時
- 新しい技術的課題発見時
- アーキテクチャ変更時

## 利点
- **コンテキスト損失防止**: セッション間での状況理解の維持
- **並行開発サポート**: 複数の開発トラックの独立管理
- **効率的な再開**: 前回の作業から迅速に継続可能
- **知識の蓄積**: 技術的詳細の保存と再利用

## 実装例

### ディレクトリ構造
```
project_root/
├── CLAUDE.md                     # プロジェクト全体指示（記憶術へのリンク含む）
├── docs/session-continuity.md    # このセッション継続システムドキュメント
├── docs/                         # プロジェクト全体ドキュメント
│   └── session_progress.md
├── component_a/
│   └── docs/
│       ├── session_progress.md
│       └── technical_details.md
└── component_b/
    └── docs/
        ├── session_progress.md
        └── technical_details.md
```

### session_progress.md テンプレート
```markdown
# セッション進捗: [コンポーネント名]

## 現在の状況
- [現在の実装状態]
- [完了した作業]
- [現在の課題]

## 次のステップ
1. [優先度高]
2. [優先度中]
3. [優先度低]

## セッション識別
**作業内容**: [具体的な作業内容の説明]
**最終更新**: [日付]
**主要ファイル**: [関連ファイルリスト]

## 技術的注意点
- [重要な技術的詳細]
- [制約事項]
- [依存関係]
```

## CLAUDE.mdへの統合
CLAUDE.mdの適切な箇所に以下を追加：
```markdown
## セッション継続システム
詳細は `docs/session-continuity.md` を参照。複数セッション間でのコンテキスト保持と並行開発管理のためのドキュメント戦略。
```

## 他プロジェクトへの移植方法

### 1. CLAUDE.mdへの統合
新しいプロジェクトのCLAUDE.mdにセッション継続システムへの参照を追加

### 2. 初期ディレクトリ作成
```bash
# プロジェクト全体のドキュメントディレクトリ
mkdir -p docs/

# 各コンポーネントのドキュメントディレクトリ（必要に応じて）
mkdir -p frontend/docs/
mkdir -p backend/docs/
mkdir -p api/docs/
```

### 3. 初期session_progress.mdの作成
各ディレクトリにテンプレートを使用してsession_progress.mdを作成

## 運用上の注意点・失敗パターン

### よくある失敗パターン
- **ドキュメント更新忘れ**: 作業完了後にドキュメントを更新せず、古い情報が残る
- **過度な詳細化**: 細かすぎる記録により可読性が低下し、むしろ効率が悪化
- **複数トラック混乱**: 並行作業時にどのセッションがどのトラックかが不明確
- **一時的な変更の記録忘れ**: 「とりあえず」の変更が記録されず、後で問題となる

### 対策
- セッション終了時に必ずドキュメント更新を習慣化
- 重要度による情報の階層化（概要→詳細の順）
- セッション開始時に前回の更新日時を確認
- 一時的な変更も簡潔にメモする習慣

## Claude Code特有の制約への対応

### セッション時間制限への対策
- 長時間作業の場合は中間地点でのドキュメント更新を必須とする
- 作業の区切りが良い時点での進捗保存を心がける
- 「次回開始時の最初のタスク」を明確に記録

### トークン制限を考慮したドキュメント設計
- 重要な情報を文書の上部に配置
- 詳細な技術情報は別ファイル（technical_details.md）に分離
- 長いログや出力結果は要約して記録

### コンテキストウィンドウの効率的使用
- セッション開始時に読み込むべきドキュメントの優先順位を明記
- 関連ファイルの参照パスを明確に記載
- 過去のセッションでの重要な決定事項を簡潔にまとめる

## トラブルシューティング

### 古いセッション情報で混乱した場合
1. 最新のgitログを確認して実際の変更履歴を把握
2. 主要ファイルの更新日時を確認
3. 実装状況とドキュメントの整合性をチェック
4. 必要に応じてドキュメントをリセットして再作成

### ドキュメントが見つからない場合
1. プロジェクトルートからの検索: `find . -name "session_progress.md"`
2. 関連する.gitignoreの確認
3. バックアップの存在確認
4. 緊急時は最小限のテンプレートから再開

### 複数開発トラックが絡み合った場合
1. 各トラックの依存関係を図示
2. 共通部分と独立部分を明確に分離
3. 優先順位を付けて段階的に整理
4. 必要に応じてトラックを統合または分割

## 効率化のヒント

### 標準化されたテンプレートとコマンド
```bash
# セッション開始時の定型コマンド
git status
git log --oneline -5

# ドキュメント確認
find . -name "session_progress.md"
```

### 情報の階層化
- **即座に必要**: 現在の状況、次のステップ
- **参考情報**: 技術的詳細、過去の経緯
- **アーカイブ**: 完了した作業、古い課題

### 定期的な整理タイミング
- 機能完成時: 関連ドキュメントの整理と更新
- 週次: 不要になったタスクの削除
- 月次: 古いドキュメントのアーカイブ

## メンテナンス指針

### 完了タスクのアーカイブ
- `docs/archive/` ディレクトリへの移動
- 完了日とバージョンタグの記録
- 主要な学習内容の抽出と保存

### 長期間未使用ドキュメントの処理
- 3ヶ月以上更新がないドキュメントのレビュー
- プロジェクト状況に応じた統廃合
- 重要な情報のみ他ドキュメントに統合

### 定期見直しサイクル
- **毎セッション開始時**: 関連session_progress.mdの確認
- **週次**: 各トラックの進捗状況確認
- **月次**: ドキュメント体系全体の見直し

## Claude Code指示: 定期的な記憶術確認

### 必須の確認タイミング
Claude Codeに以下の指示を含めることを強く推奨：

```markdown
## セッション開始プロトコル
新しいセッション開始時は必ず以下を実行：

1. **記憶術システムの確認**: `docs/session-continuity.md`を参照し、このシステムの存在を思い出す
2. **関連進捗の読み込み**: 作業予定のコンポーネントの`docs/session_progress.md`を確認
3. **前回セッションからの継続性確認**: 最後の更新から現在までの間隔と状況変化をチェック

これにより、各セッションでの作業効率と品質を維持する。
```

### 忘却防止のための仕組み
- CLAUDE.mdのプロジェクト概要部分に記憶術への参照を必ず含める
- 主要コンポーネントのREADMEにもセッション継続システムへの言及を追加
- 定期的に記憶術ドキュメント自体の見直しと改善を実施