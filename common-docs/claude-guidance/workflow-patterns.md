# Claude Code 開発ワークフローパターン

Claude Code を使用した効率的な開発ワークフローと協働パターンを説明します。

## 基本的な開発サイクル

### 1. セッション開始プロトコル

新しいセッション開始時は必ず以下を実行：

```
1. 記憶術システムの確認
   - `./docs/session-continuity.md` の確認
   - このシステムの存在を思い出す

2. 関連進捗の読み込み
   - 作業予定コンポーネントの `app/docs/session_progress.md` を確認
   - 前回までの進捗状況を把握

3. 継続性の確認
   - 最後の更新から現在までの間隔をチェック
   - 状況変化や新しい要件を確認
```

### 2. タスク分解パターン

**大きなタスクの分解方針:**
- 3-4時間で完了できる単位に分割
- 各タスクは独立してテスト可能
- 段階的なマージが可能な構成

**例: 認証機能実装**
```
Phase 1: 基本認証フロー
├── ユーザー登録API実装
├── ログイン・ログアウト機能
└── セッション管理

Phase 2: セキュリティ強化
├── パスワード要件強化
├── ログイン試行回数制限
└── セッション有効期限管理

Phase 3: OAuth統合
├── OAuth 2.0フロー実装
├── 外部認証プロバイダー連携
└── アカウント統合機能
```

### 3. コードレビューパターン

**Claude Codeとの協働レビュー:**

1. **構造レビュー**
   - アーキテクチャパターンの一貫性
   - 命名規約の遵守
   - 型安全性の確保

2. **セキュリティレビュー**
   - 入力値検証の徹底
   - 認証・認可の適切な実装
   - 機密情報の適切な取り扱い

3. **保守性レビュー**
   - コードの可読性
   - テストケースの網羅性
   - ドキュメント化の適切性

### 4. デバッグワークフロー

**段階的デバッグアプローチ:**

```
1. 問題の特定
   ├── エラーメッセージの詳細分析
   ├── 再現手順の明確化
   └── 影響範囲の特定

2. 原因調査
   ├── ログ分析
   ├── データフロー追跡
   └── 関連コンポーネントの確認

3. 修正実装
   ├── 最小限の変更で修正
   ├── テストケース追加
   └── 回帰テスト実行

4. 検証・文書化
   ├── 修正内容の動作確認
   ├── 問題・解決策の文書化
   └── 予防策の検討
```

## 効率化テクニック

### 1. 並行作業パターン

**複数ファイルの同時作業:**
- 関連性の低いファイルは並行して編集
- 依存関係のあるファイルは順次作業
- 大きな変更は段階的にコミット

### 2. 検索・調査パターン

**効率的なコードベース理解:**
```bash
# 機能の実装場所特定
grep -r "function createUser" --include="*.ts"

# 関連する型定義の確認
find . -name "*.ts" -exec grep -l "UserType" {} \;

# API エンドポイントの一覧
grep -r "router\." server/src/api/ --include="*.ts"
```

### 3. テスト駆動開発（TDD）パターン

**Claude Codeとの協働TDD:**
1. テストケース作成（期待動作の明確化）
2. 最小限の実装（テストが通る最小コード）
3. リファクタリング（コード品質向上）
4. 統合テスト（システム全体の動作確認）

## コミュニケーションパターン

### 1. 明確な指示の出し方

**効果的な指示例:**
```
良い例:
「users テーブルの email フィールドにユニーク制約を追加し、
既存データの重複チェック機能も実装してください」

悪い例:
「メール周りを修正して」
```

### 2. 段階的な確認パターン

**複雑な変更の段階的実施:**
1. 設計方針の確認・合意
2. 段階的な実装（小さな単位で確認）
3. 統合テストとフィードバック
4. 最終調整と完成

### 3. 問題報告パターン

**効果的な問題報告:**
```
1. 現象の詳細
   - 何をしたときに
   - どのような問題が発生したか
   - エラーメッセージの内容

2. 環境情報
   - OS・ブラウザ情報
   - 関連するバージョン情報
   - 再現手順

3. 期待される動作
   - 本来どうあるべきか
   - 影響範囲や優先度
```

## 品質保証パターン

### 1. 継続的品質確保

**開発プロセスに組み込む品質チェック:**
- コード書式の自動整形
- 型チェックの自動実行
- テストカバレッジの監視
- セキュリティ脆弱性チェック

### 2. ドキュメント品質

**保守可能なドキュメント作成:**
- コード変更と同時にドキュメント更新
- サンプルコードの動作確認
- 図表を使った分かりやすい説明
- 定期的なドキュメントレビュー

これらのパターンを活用することで、Claude Code との協働による高効率・高品質な開発が実現できます。